<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel LAN Center</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- LOGO -->
<div class="top-logo">
  <img src="logo.png" class="logo">
</div>

<h1 class="titulo">PANEL LAN CENTER JACKNNIEL</h1>

<h2 class="rol" id="rolTexto"></h2>

<!-- ğŸ” ADMIN PANEL -->
<div id="adminPanel" class="admin-box" style="display:none;">
  <h2>ğŸ” ADMIN: Subir Links QR</h2>

  <p>Banco UniÃ³n</p>
  <input id="link1" placeholder="Link QR Banco UniÃ³n">
  <button class="btn" onclick="guardarQR('banco_union','link1')">Guardar</button>

  <p>Yasta</p>
  <input id="link2" placeholder="Link QR Yasta">
  <button class="btn" onclick="guardarQR('yasta','link2')">Guardar</button>

  <p>Tigo Money</p>
  <input id="link3" placeholder="Link QR Tigo Money">
  <button class="btn" onclick="guardarQR('tigo','link3')">Guardar</button>

  <p>BNB</p>
  <input id="link4" placeholder="Link QR BNB">
  <button class="btn" onclick="guardarQR('bnb','link4')">Guardar</button>
</div>

<!-- ğŸ‘€ OPERADORES -->
<div class="grid">

  <!-- BANCO 1 -->
  <div class="card-pro">
    <h2>Banco UniÃ³n</h2>
    <button class="btn" onclick="verQR('banco_union','img1')">Mostrar QR</button>

    <img id="img1" class="qr-img">

    <button class="btn-copy" onclick="copiarQR('img1')">ğŸ“‹ Copiar</button>
    <button class="btn-copy" onclick="descargarQR('img1','BancoUnion')">â¬‡ Descargar</button>
  </div>

  <!-- BANCO 2 -->
  <div class="card-pro">
    <h2>Yasta</h2>
    <button class="btn" onclick="verQR('yasta','img2')">Mostrar QR</button>

    <img id="img2" class="qr-img">

    <button class="btn-copy" onclick="copiarQR('img2')">ğŸ“‹ Copiar</button>
    <button class="btn-copy" onclick="descargarQR('img2','Yasta')">â¬‡ Descargar</button>
  </div>

  <!-- BANCO 3 -->
  <div class="card-pro">
    <h2>Tigo Money</h2>
    <button class="btn" onclick="verQR('tigo','img3')">Mostrar QR</button>

    <img id="img3" class="qr-img">

    <button class="btn-copy" onclick="copiarQR('img3')">ğŸ“‹ Copiar</button>
    <button class="btn-copy" onclick="descargarQR('img3','TigoMoney')">â¬‡ Descargar</button>
  </div>

  <!-- BANCO 4 -->
  <div class="card-pro">
    <h2>BNB</h2>
    <button class="btn" onclick="verQR('bnb','img4')">Mostrar QR</button>

    <img id="img4" class="qr-img">

    <button class="btn-copy" onclick="copiarQR('img4')">ğŸ“‹ Copiar</button>
    <button class="btn-copy" onclick="descargarQR('img4','BNB')">â¬‡ Descargar</button>
  </div>

</div>

<!-- WHATSAPP -->
<button class="btn-wsp"
onclick="window.open('https://wa.me/60772546')">
ğŸ“² Enviar WhatsApp
</button>

<br>

<button class="btn-salir" onclick="logout()">Salir</button>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDhR3XZX9EG1sLuOvBefZ2EA5GVn8-SggQ",
    authDomain: "panel-jacknniel.firebaseapp.com",
    projectId: "panel-jacknniel",
    storageBucket: "panel-jacknniel.firebasestorage.app",
    messagingSenderId: "130186632575",
    appId: "1:130186632575:web:135d0352564c290d6d0e4a"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  let rol = localStorage.getItem("rol");
  let user = localStorage.getItem("user");

  document.getElementById("rolTexto").innerText =
    "Usuario: " + user + " | Rol: " + rol;

  if (rol === "admin") {
    document.getElementById("adminPanel").style.display = "block";
  }

  // âœ… Guardar QR
  function guardarQR(banco,inputID) {

    if (rol !== "admin") return alert("Solo admin");

    let link = document.getElementById(inputID).value;

    db.collection("qr_links").doc(banco).set({
      url: link
    });

    alert("âœ… Guardado correctamente");
  }

  // âœ… Mostrar QR
  function verQR(banco,imgID) {

    db.collection("qr_links").doc(banco).get()
    .then((doc)=>{

      if (!doc.exists) return alert("No hay QR guardado");

      document.getElementById(imgID).src = doc.data().url;
    });
  }

  // âœ… Zoom QR
  document.addEventListener("click", function(e){
    if(e.target.classList.contains("qr-img")){
      e.target.classList.toggle("zoom");
    }
  });

  // âœ… Copiar QR
  function copiarQR(imgID){
    let url = document.getElementById(imgID).src;
    navigator.clipboard.writeText(url);
    alert("âœ… Link copiado");
  }

  // âœ… Descargar QR
  function descargarQR(imgID,nombre){

    let url = document.getElementById(imgID).src;

    let a = document.createElement("a");
    a.href = url;
    a.download = nombre + ".png";
    a.click();
  }

  // âœ… Logout
  function logout(){
    localStorage.clear();
    window.location.href="login.html";
  }
</script>

</body>
</html>
