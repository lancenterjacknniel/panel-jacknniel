<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel LAN Center</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<h1>ğŸš€ PANEL LAN CENTER JACKNNIEL</h1>

<p id="rolText"></p>

<!-- âœ… ADMIN PANEL -->
<div id="adminPanel" style="display:none;">
  <h2>ğŸ‘‘ Solo Admin puede subir links QR</h2>

  <h3>Banco UniÃ³n</h3>
  <input id="linkBanco" placeholder="Pega link Google Drive Banco UniÃ³n">
  <button onclick="guardarQR('banco_union')">Guardar</button>

  <h3>Yasta</h3>
  <input id="linkYasta" placeholder="Pega link Google Drive Yasta">
  <button onclick="guardarQR('yasta')">Guardar</button>

  <hr>
</div>

<!-- âœ… OPERADORES -->
<h2>ğŸ“Œ Operadores solo pueden ver QR</h2>

<div class="cardQR">
  <h3>Banco UniÃ³n</h3>
  <button onclick="verQR('banco_union')">Mostrar QR</button>
  <img id="imgBanco" width="250">
</div>

<div class="cardQR">
  <h3>Yasta</h3>
  <button onclick="verQR('yasta')">Mostrar QR</button>
  <img id="imgYasta" width="250">
</div>

<!-- WhatsApp -->
<br><br>
<a id="wspBtn" target="_blank">
  <button>ğŸ“² Enviar WhatsApp</button>
</a>

<!-- Firebase CDN -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js"></script>

<script>
  // CONFIG FIREBASE
  const firebaseConfig = {
    apiKey: "AIzaSyDhR3XZX9EG1sLuOvBefZ2EA5GVn8-SggQ",
    authDomain: "panel-jacknniel.firebaseapp.com",
    projectId: "panel-jacknniel",
    storageBucket: "panel-jacknniel.firebasestorage.app",
    messagingSenderId: "130186632575",
    appId: "1:130186632575:web:135d0352564c290d6d0e4a"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // WHATSAPP
  const whatsapp = "60772546";
  document.getElementById("wspBtn").href =
    "https://wa.me/591" + whatsapp;

  // VER ROL
  let rol = localStorage.getItem("rol");

  document.getElementById("rolText").innerText =
    "Rol: " + rol;

  if (rol === "admin") {
    document.getElementById("adminPanel").style.display = "block";
  }

  // GUARDAR QR (solo admin)
  function guardarQR(banco) {

    if (rol !== "admin") {
      alert("âŒ Solo el admin puede guardar QR");
      return;
    }

    let link = "";

    if (banco === "banco_union") {
      link = document.getElementById("linkBanco").value;
    }

    if (banco === "yasta") {
      link = document.getElementById("linkYasta").value;
    }

    db.collection("qr_links").doc(banco).set({
      url: link
    });

    alert("âœ… QR Guardado correctamente");
  }

  // VER QR (todos)
  function verQR(banco) {

    db.collection("qr_links").doc(banco).get()
      .then((doc) => {

        if (!doc.exists) {
          alert("âŒ No hay QR guardado");
          return;
        }

        let url = doc.data().url;

        if (banco === "banco_union") {
          document.getElementById("imgBanco").src = url;
        }

        if (banco === "yasta") {
          document.getElementById("imgYasta").src = url;
        }

      });
  }
</script>

</body>
</html>
